<!-- ç”¨æˆ·ä¸­å¿ƒé¦–é¡µ -->
<view class="page {{theme === 'dark' ? 'dark-mode' : (theme === 'light' ? 'light' : '') }} {{appVersion === 'elderly' ? 'elderly-mode' : ''}}">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view wx:if="{{!isLoggedIn}}" class="login-prompt">
    <view class="login-avatar-box">
      <view class="login-avatar-placeholder">ğŸ‘¤</view>
    </view>
    <text class="login-hint">ç™»å½•åäº«å—æ›´å¤šæœåŠ¡</text>
    <view class="login-buttons">
      <view class="login-btn primary" bindtap="goToLogin">
        <text>ç™»å½•/æ³¨å†Œ</text>
      </view>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else>
    <!-- ç”¨æˆ·å¡ç‰‡ -->
    <view class="user-card" style="{{backgroundType === 'image' && userInfo.background ? 'background-image: url(' + userInfo.background + ')' : (userInfo.background ? 'background: ' + userInfo.background : '')}}">
      <view class="user-card-bg" style="{{backgroundType !== 'image' && userInfo.background ? 'background: ' + userInfo.background : 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)'}}"></view>
      <image class="user-avatar" src="{{userInfo.avatar || 'https://picsum.photos/200/200?random=10'}}" mode="aspectFill"></image>
      <view class="user-info">
        <view class="user-name-row">
          <text class="user-nickname">{{userInfo.nickname || 'æ—…è¡Œè€…'}}</text>
          <text class="identity-badge">{{userInfo.identity === 'villager' ? 'æ‘æ°‘' : 'æ¸¸æ°‘'}}</text>
        </view>
        <view class="user-meta-row">
          <text class="user-gender">{{userInfo.gender === 'male' ? 'â™‚ ç”·' : (userInfo.gender === 'female' ? 'â™€ å¥³' : '')}}</text>
          <text class="user-age" wx:if="{{userInfo.age}}"> Â· {{userInfo.age}}å²</text>
          <text class="user-id" wx:if="{{userInfo.id}}"> Â· ID: {{userInfo.id}}</text>
        </view>
        <text class="user-signature">{{userInfo.signature || 'è¿™ä¸ªäººå¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡å†™'}}</text>
      </view>
    </view>

    <!-- ç¼–è¾‘èµ„æ–™æŒ‰é’® -->
    <view class="edit-profile-bar">
      <view class="edit-profile-btn" bindtap="goToEditProfile">
        <text>ç¼–è¾‘èµ„æ–™</text>
      </view>
    </view>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-section">
      <view class="stat-item">
        <text class="stat-value">{{stats.postCount}}</text>
        <text class="stat-label">å‘å¸–</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{stats.commentCount}}</text>
        <text class="stat-label">è¯„è®º</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-value">{{stats.likeCount}}</text>
        <text class="stat-label">è·èµ</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå•ï¼ˆåªæœ‰å·²ç™»å½•æ‰æ˜¾ç¤ºï¼Œé¿å…è¦†ç›–é—®é¢˜ï¼‰ -->
  <view wx:if="{{isLoggedIn}}" class="menu-section">
    <view 
      class="menu-item"
      wx:for="{{menuList}}"
      wx:key="id"
      bindtap="onMenuTap"
      data-path="{{item.path}}"
    >
      <view class="menu-left">
        <text class="menu-icon">{{item.icon}}</text>
        <text class="menu-title">{{item.title}}</text>
      </view>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>
</view>