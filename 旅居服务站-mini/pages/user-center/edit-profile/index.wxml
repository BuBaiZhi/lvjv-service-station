<!-- 编辑资料页面 -->
<view class="page {{theme === 'dark' ? 'dark-mode' : ''}} {{appVersion === 'elderly' ? 'elderly-mode' : ''}}">
  <!-- 用户信息卡片 -->
  <view class="user-card" style="{{backgroundType === 'image' ? 'background-image: url(' + userInfo.background + ')' : (userInfo.background ? 'background: ' + userInfo.background : '')}}">
    <view class="user-card-bg" style="{{backgroundType !== 'image' && userInfo.background ? 'background: ' + userInfo.background : 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)'}}"></view>
    <image class="user-avatar" src="{{userInfo.avatar || 'https://picsum.photos/200/200?random=10'}}" mode="aspectFill"></image>
    <view class="user-info">
      <view class="user-name-row">
        <text class="user-nickname">{{userInfo.nickname}}</text>
        <text class="identity-badge">{{userInfo.identity === 'villager' ? '村民' : '游民'}}</text>
      </view>
      <view class="user-meta-row">
        <text class="user-gender">{{userInfo.gender === 'male' ? '♂ 男' : '♀ 女'}}</text>
        <text class="user-age" wx:if="{{userInfo.age}}"> · {{userInfo.age}}岁</text>
        <text class="user-id"> · ID: {{userInfo.id || '2123'}}</text>
      </view>
    </view>
    <!-- 更换背景按钮 -->
    <view class="change-bg-btn" bindtap="changeBackground">
      <text>更换背景</text>
    </view>
  </view>

  <!-- 表单区域 -->
  <view class="form-section">
    <!-- 头像 -->
    <view class="form-item">
      <text class="label">更换头像</text>
      <view class="avatar-edit-wrapper" bindtap="changeAvatar">
        <image class="avatar-large" src="{{userInfo.avatar || 'https://picsum.photos/200/200?random=10'}}" mode="aspectFill"></image>
        <view class="change-tip">点击更换</view>
      </view>
    </view>

    <!-- 昵称 -->
    <view class="form-item">
      <text class="label">昵称</text>
      <input 
        class="input" 
        value="{{userInfo.nickname}}" 
        placeholder="请输入昵称"
        bindinput="onNicknameInput"
      />
    </view>

    <!-- 性别 -->
    <view class="form-item">
      <text class="label">性别</text>
      <view class="gender-picker">
        <view 
          class="gender-item {{userInfo.gender === 'male' ? 'active' : ''}}"
          bindtap="selectGender"
          data-gender="male"
        >
          <text>男</text>
        </view>
        <view 
          class="gender-item {{userInfo.gender === 'female' ? 'active' : ''}}"
          bindtap="selectGender"
          data-gender="female"
        >
          <text>女</text>
        </view>
      </view>
    </view>

    <!-- 年龄 -->
    <view class="form-item">
      <text class="label">年龄</text>
      <input 
        class="input" 
        type="number"
        value="{{userInfo.age}}" 
        placeholder="请输入年龄"
        bindinput="onAgeInput"
      />
    </view>

    <!-- 手机号 -->
    <view class="form-item">
      <text class="label">手机号</text>
      <input 
        class="input" 
        type="number"
        value="{{userInfo.phone}}" 
        placeholder="请输入手机号"
        bindinput="onPhoneInput"
      />
    </view>

    <!-- 个性签名 -->
    <view class="form-item">
      <text class="label">个性签名</text>
      <textarea 
        class="textarea" 
        value="{{userInfo.signature}}" 
        placeholder="写点什么介绍一下自己吧~"
        bindinput="onSignatureInput"
        maxlength="100"
      />
      <view class="char-count">{{userInfo.signature.length}}/100</view>
    </view>

    <!-- 保存按钮 -->
    <view class="btn-wrapper">
      <button class="btn btn-primary" bindtap="saveProfile">保存</button>
    </view>
  </view>
</view>
