# 我的交易页面设计文档

## 📋 页面概述

**页面名称**：我的交易  
**路由**：`/pages/user-center/order-list`  
**功能**：管理用户的所有交易订单（房源预订、活动报名、技能服务）  
**优先级**：⭐⭐⭐ 核心功能  

---

## 🎯 功能需求

### 核心功能

1. **交易列表展示**
   - 显示所有交易订单
   - 支持下拉刷新
   - 支持上拉加载
   - 显示交易状态

2. **交易操作**
   - 查看交易详情
   - 确认交易
   - 完成交易
   - 评价交易
   - 删除交易
   - 取消交易

3. **交易状态管理**
   - 待确认
   - 已确认
   - 已完成
   - 已取消

4. **交易类型**
   - 房源预订
   - 活动报名
   - 技能服务

---

## 📐 页面布局

### 整体结构

```
┌─────────────────────────────────┐
│ ← 返回    我的交易              │  ← 页面头部
├─────────────────────────────────┤
│                                 │
│  交易卡片 1                     │
│  ┌─────────────────────────────┐│
│  │ [图]  标题          [状态]  ││
│  │ 100x │  描述...              ││
│  │ 100  │  ¥价格  2024-02-10   ││
│  │      │              [操作]  ││
│  └─────────────────────────────┘│
│                                 │
│  交易卡片 2                     │
│  ...                            │
│                                 │
│  [加载更多]                     │
│                                 │
└─────────────────────────────────┘
```

### 页面头部

**高度**：56px  
**背景**：白色 `#FFFFFF`  
**阴影**：中阴影  

**组件**：
- 返回按钮（左侧）：`←`
- 页面标题（中间）：`我的交易`
- 空白（右侧）

### 交易卡片

**布局**：左图右文

```
┌─────────────────────────────────┐
│ [图]  标题              [状态]  │
│ 100x │  描述信息...              │
│ 100  │  ¥价格    2024-02-10     │
│      │                  [操作]  │
└─────────────────────────────────┘
```

**尺寸**：
- 卡片高度：120px
- 图片宽度：100px
- 图片高度：100px
- 圆角：12px
- 阴影：中阴影
- 间距：12px

**内容**：
- 标题：18px 600 深灰色
- 描述：14px 400 中灰色
- 价格：16px 600 绿色
- 时间：12px 400 浅灰色
- 状态标签：12px 600 白色

**状态标签颜色**：
- 待确认：黄色背景 `#FFF3CD` + 深黄文字
- 已确认：蓝色背景 `#D1ECF1` + 深蓝文字
- 已完成：绿色背景 `#D4EDDA` + 深绿文字
- 已取消：红色背景 `#F8D7DA` + 深红文字

### 空状态

```
        📦
      暂无交易
    [返回首页]
```

**组件**：
- 图标：48px emoji
- 文字：14px 中灰色
- 按钮：绿色按钮

---

## 🔄 交互流程

### 页面加载

```
页面打开
    ↓
加载交易列表
    ↓
显示交易卡片
    ↓
页面就绪
```

### 交易操作

```
点击交易卡片
    ↓
打开交易详情页
    ↓
显示交易信息和操作按钮
    ↓
用户选择操作
    ↓
执行操作
    ↓
显示成功提示
    ↓
返回交易列表
```

### 下拉刷新

```
用户下拉
    ↓
显示刷新动画
    ↓
重新加载交易列表
    ↓
隐藏刷新动画
    ↓
显示最新数据
```

### 上拉加载

```
用户滚动到底部
    ↓
显示加载动画
    ↓
加载更多交易
    ↓
隐藏加载动画
    ↓
追加显示新交易
```

---

## 📊 数据结构

### 交易对象

```typescript
interface Order {
  id: string                    // 交易 ID
  title: string                 // 交易标题
  description: string           // 交易描述
  image: string                 // 交易图片 URL
  price: number                 // 交易价格
  status: 'pending' | 'confirmed' | 'completed' | 'cancelled'
  type: 'house' | 'activity' | 'skill'
  createTime: string            // 创建时间 (YYYY-MM-DD)
  updateTime: string            // 更新时间
  seller: {
    id: string
    name: string
    avatar: string
  }
  actions: string[]             // 可用操作列表
}
```

### Mock 数据示例

```typescript
const mockOrders = [
  {
    id: '1',
    title: '乡村民宿预订',
    description: '2024年2月15日-2月18日',
    image: 'https://example.com/house.jpg',
    price: 1200,
    status: 'pending',
    type: 'house',
    createTime: '2024-02-10',
    updateTime: '2024-02-10',
    seller: {
      id: '101',
      name: '张三',
      avatar: 'https://example.com/avatar.jpg'
    },
    actions: ['confirm', 'cancel']
  },
  {
    id: '2',
    title: '乡村手工艺体验',
    description: '陶艺制作课程',
    image: 'https://example.com/activity.jpg',
    price: 88,
    status: 'confirmed',
    type: 'activity',
    createTime: '2024-02-08',
    updateTime: '2024-02-09',
    seller: {
      id: '102',
      name: '李四',
      avatar: 'https://example.com/avatar2.jpg'
    },
    actions: ['complete', 'rate', 'cancel']
  }
]
```

---

## 🎨 样式规范

### 颜色

| 元素 | 颜色 | 用途 |
|------|------|------|
| 背景 | `#F5F5F5` | 页面背景 |
| 卡片 | `#FFFFFF` | 交易卡片 |
| 标题 | `#212121` | 交易标题 |
| 描述 | `#757575` | 交易描述 |
| 价格 | `#4CAF50` | 交易价格 |
| 时间 | `#BDBDBD` | 交易时间 |
| 待确认 | `#FFF3CD` | 待确认状态 |
| 已确认 | `#D1ECF1` | 已确认状态 |
| 已完成 | `#D4EDDA` | 已完成状态 |
| 已取消 | `#F8D7DA` | 已取消状态 |

### 间距

```
页面内边距：16px
卡片间距：12px
卡片内边距：12px
```

### 圆角

```
卡片：12px
按钮：8px
图片：8px
```

---

## 🔧 技术实现

### 状态管理

```typescript
// 页面状态
const orderList = ref<Order[]>([])  // 交易列表
const loading = ref(false)          // 加载状态
const refreshing = ref(false)       // 刷新状态
const hasMore = ref(true)           // 是否有更多数据
const page = ref(1)                 // 当前页码
```

### 计算属性

```typescript
// 状态标签
const statusLabel = (status: string) => {
  const labels: Record<string, string> = {
    pending: '待确认',
    confirmed: '已确认',
    completed: '已完成',
    cancelled: '已取消'
  }
  return labels[status] || status
}
```

### 方法

```typescript
// 加载交易列表
const loadOrders = async () => {
  loading.value = true
  try {
    // 模拟 API 调用
    await new Promise(resolve => setTimeout(resolve, 500))
    orderList.value = mockOrders
  } finally {
    loading.value = false
  }
}

// 下拉刷新
const onRefresh = async () => {
  refreshing.value = true
  try {
    page.value = 1
    await loadOrders()
  } finally {
    refreshing.value = false
  }
}

// 上拉加载
const onLoadMore = async () => {
  if (!hasMore.value || loading.value) return
  loading.value = true
  try {
    page.value++
    // 模拟加载更多
    await new Promise(resolve => setTimeout(resolve, 500))
  } finally {
    loading.value = false
  }
}

// 交易操作
const handleAction = (orderId: string, action: string) => {
  console.log(`执行操作: ${action} on order ${orderId}`)
  // 显示成功提示
  if (typeof uni === 'undefined') {
    alert('操作成功')
  } else {
    uni.showToast({ title: '操作成功', icon: 'success' })
  }
}

// 返回
const goBack = () => {
  if (typeof uni === 'undefined') {
    window.history.back()
  } else {
    uni.navigateBack()
  }
}
```

---

## 📱 响应式设计

### 小屏幕（< 576px）

- 卡片高度：100px
- 图片尺寸：80x80
- 字体缩小 10%
- 间距缩小 10%

### 中屏幕（576px - 768px）

- 卡片高度：120px
- 图片尺寸：100x100
- 标准字体
- 标准间距

### 大屏幕（> 768px）

- 卡片高度：140px
- 图片尺寸：120x120
- 字体放大 10%
- 间距放大 10%

---

## 🧪 测试清单

### 功能测试

- [ ] 页面加载正常
- [ ] 交易列表显示正确
- [ ] 下拉刷新正常
- [ ] 上拉加载正常
- [ ] 交易操作正常
- [ ] 空状态显示正确
- [ ] 加载状态显示正确

### 界面测试

- [ ] 布局美观
- [ ] 文字清晰
- [ ] 颜色搭配
- [ ] 间距合理
- [ ] 卡片显示完整
- [ ] 状态标签清晰

### 交互测试

- [ ] 返回按钮正常
- [ ] 卡片点击响应
- [ ] 操作按钮响应
- [ ] 加载动画显示
- [ ] 刷新动画显示

### 兼容性测试

- [ ] 浏览器环境
- [ ] uni-app 环境
- [ ] 微信小程序
- [ ] 不同屏幕尺寸

---

## 📝 开发检查清单

- [ ] 页面结构完整
- [ ] 样式规范统一
- [ ] 数据绑定正确
- [ ] 交互流程清晰
- [ ] 错误处理完善
- [ ] 加载状态处理
- [ ] 空状态处理
- [ ] 响应式适配
- [ ] 代码注释完整
- [ ] 文档更新完整

---

**文档版本**：1.0.0  
**最后更新**：2026-02-12  
**维护者**：Kiro AI Assistant
