# 设置页面设计文档

## 📋 页面概述

**页面名称**：设置  
**路由**：`/pages/user-center/settings`  
**功能**：管理用户的账户设置和应用设置  
**优先级**：⭐⭐ 系统功能  

---

## 🎯 功能需求

### 核心功能

1. **账户设置**
   - 编辑个人资料
   - 卡片背景编辑
   - 身份切换（村民/游民）

2. **通知设置**
   - 启用/禁用通知
   - 隐私模式开关

3. **显示设置**
   - 深色模式开关

4. **其他设置**
   - 清除缓存
   - 关于应用
   - 退出登录

---

## 📐 页面布局

### 整体结构

```
┌─────────────────────────────────┐
│ ← 返回    设置                  │  ← 页面头部
├─────────────────────────────────┤
│                                 │
│  账户设置                       │
│  ┌─────────────────────────────┐│
│  │ 编辑个人资料              › ││
│  │ 修改昵称、头像等信息        ││
│  ├─────────────────────────────┤│
│  │ 卡片背景                  › ││
│  │ 选择或上传卡片背景          ││
│  ├─────────────────────────────┤│
│  │ 身份切换                [◯] ││
│  │ 在村民和游民之间切换        ││
│  └─────────────────────────────┘│
│                                 │
│  通知设置                       │
│  ┌─────────────────────────────┐│
│  │ 启用通知                [◯] ││
│  │ 接收订单和消息通知          ││
│  ├─────────────────────────────┤│
│  │ 隐私模式                [◯] ││
│  │ 隐藏个人信息和活动记录      ││
│  └─────────────────────────────┘│
│                                 │
│  显示设置                       │
│  ┌─────────────────────────────┐│
│  │ 深色模式                [◯] ││
│  │ 在深色和浅色主题之间切换    ││
│  └─────────────────────────────┘│
│                                 │
│  其他                           │
│  ┌─────────────────────────────┐│
│  │ 清除缓存                  › ││
│  │ 清除应用缓存数据            ││
│  ├─────────────────────────────┤│
│  │ 关于应用                  › ││
│  │ 版本 1.0.0                  ││
│  ├─────────────────────────────┤│
│  │ 退出登录                  › ││
│  └─────────────────────────────┘│
│                                 │
│  [底部间距]                     │
│                                 │
└─────────────────────────────────┘
```

### 页面头部

**高度**：56px  
**背景**：白色 `#FFFFFF`  
**阴影**：中阴影  

**组件**：
- 返回按钮（左侧）：`←`
- 页面标题（中间）：`设置`
- 空白（右侧）

### 设置分组

**布局**：分组菜单式

```
┌─────────────────────────────────┐
│ 账户设置                        │  ← 分组标题
├─────────────────────────────────┤
│ 编辑个人资料              ›     │  ← 设置项
│ 修改昵称、头像等信息            │
├─────────────────────────────────┤
│ 卡片背景                  ›     │
│ 选择或上传卡片背景              │
├─────────────────────────────────┤
│ 身份切换                  [◯]   │
│ 在村民和游民之间切换            │
└─────────────────────────────────┘
```

**尺寸**：
- 分组标题高度：40px
- 设置项高度：60px
- 圆角：12px
- 阴影：浅阴影
- 间距：12px

**内容**：
- 分组标题：14px 600 浅灰色
- 设置标题：16px 600 深灰色
- 设置描述：12px 400 中灰色
- 控制元素：开关/箭头

### 设置项类型

**1. 导航项**
```
编辑个人资料              ›
修改昵称、头像等信息
```

**2. 开关项**
```
身份切换                  [◯]
在村民和游民之间切换
```

**3. 危险项**
```
退出登录                  ›
```

---

## 🔄 交互流程

### 页面加载

```
页面打开
    ↓
加载设置数据
    ↓
显示设置项
    ↓
页面就绪
```

### 编辑个人资料

```
点击编辑个人资料
    ↓
跳转到编辑资料页
    ↓
显示编辑表单
```

### 编辑卡片背景

```
点击卡片背景
    ↓
打开背景选择器
    ↓
选择背景
    ↓
确认保存
```

### 切换身份

```
点击开关
    ↓
切换身份状态
    ↓
显示成功提示
    ↓
更新用户信息
```

### 切换通知

```
点击开关
    ↓
切换通知状态
    ↓
显示成功提示
    ↓
保存设置
```

### 切换隐私模式

```
点击开关
    ↓
切换隐私模式
    ↓
显示成功提示
    ↓
保存设置
```

### 切换深色模式

```
点击开关
    ↓
切换主题
    ↓
应用新主题
    ↓
保存设置
```

### 清除缓存

```
点击清除缓存
    ↓
显示确认对话框
    ↓
用户确认
    ↓
执行清除操作
    ↓
显示成功提示
```

### 关于应用

```
点击关于应用
    ↓
跳转到关于页面
    ↓
显示应用信息
```

### 退出登录

```
点击退出登录
    ↓
显示确认对话框
    ↓
用户确认
    ↓
执行退出操作
    ↓
返回登录页
```

---

## 📊 数据结构

### 设置对象

```typescript
interface Settings {
  // 账户设置
  identity: 'villager' | 'nomad'        // 身份
  
  // 通知设置
  notificationEnabled: boolean           // 通知启用
  privacyMode: boolean                   // 隐私模式
  
  // 显示设置
  theme: 'light' | 'dark'               // 主题
  
  // 其他
  cacheSize?: number                     // 缓存大小
  appVersion?: string                    // 应用版本
}
```

### 设置项对象

```typescript
interface SettingItem {
  id: string                    // 设置项 ID
  title: string                 // 标题
  description: string           // 描述
  type: 'navigate' | 'toggle' | 'danger'  // 类型
  value?: boolean               // 当前值（开关项）
  action?: () => void           // 操作函数
}
```

### Mock 数据示例

```typescript
const mockSettings = {
  identity: 'villager',
  notificationEnabled: true,
  privacyMode: false,
  theme: 'light',
  cacheSize: 25.6,
  appVersion: '1.0.0'
}

const settingGroups = [
  {
    title: '账户设置',
    items: [
      {
        id: 'edit-profile',
        title: '编辑个人资料',
        description: '修改昵称、头像等信息',
        type: 'navigate'
      },
      {
        id: 'edit-background',
        title: '卡片背景',
        description: '选择或上传卡片背景',
        type: 'navigate'
      },
      {
        id: 'switch-identity',
        title: '身份切换',
        description: '在村民和游民之间切换',
        type: 'toggle',
        value: true
      }
    ]
  },
  {
    title: '通知设置',
    items: [
      {
        id: 'notification',
        title: '启用通知',
        description: '接收订单和消息通知',
        type: 'toggle',
        value: true
      },
      {
        id: 'privacy-mode',
        title: '隐私模式',
        description: '隐藏个人信息和活动记录',
        type: 'toggle',
        value: false
      }
    ]
  },
  {
    title: '显示设置',
    items: [
      {
        id: 'dark-mode',
        title: '深色模式',
        description: '在深色和浅色主题之间切换',
        type: 'toggle',
        value: false
      }
    ]
  },
  {
    title: '其他',
    items: [
      {
        id: 'clear-cache',
        title: '清除缓存',
        description: '清除应用缓存数据',
        type: 'navigate'
      },
      {
        id: 'about',
        title: '关于应用',
        description: '版本 1.0.0',
        type: 'navigate'
      },
      {
        id: 'logout',
        title: '退出登录',
        description: '',
        type: 'danger'
      }
    ]
  }
]
```

---

## 🎨 样式规范

### 颜色

| 元素 | 颜色 | 用途 |
|------|------|------|
| 背景 | `#F5F5F5` | 页面背景 |
| 卡片 | `#FFFFFF` | 设置卡片 |
| 标题 | `#212121` | 设置标题 |
| 描述 | `#757575` | 设置描述 |
| 分组标题 | `#BDBDBD` | 分组标题 |
| 开关启用 | `#4CAF50` | 开关启用 |
| 开关禁用 | `#BDBDBD` | 开关禁用 |
| 危险项 | `#F44336` | 危险项文字 |

### 间距

```
页面内边距：16px
分组间距：12px
分组内边距：0
设置项内边距：16px
```

### 圆角

```
卡片：12px
开关：9999px
```

---

## 🔧 技术实现

### 状态管理

```typescript
// 页面状态
const settings = ref<Settings>({
  identity: 'villager',
  notificationEnabled: true,
  privacyMode: false,
  theme: 'light'
})
const loading = ref(false)
```

### 方法

```typescript
// 切换身份
const switchIdentity = (event: any) => {
  const identity = event.target.checked ? 'villager' : 'nomad'
  settings.value.identity = identity as 'villager' | 'nomad'
  
  if (typeof uni === 'undefined') {
    alert(`已切换为${identity === 'villager' ? '村民' : '数字游民'}`)
  } else {
    uni.showToast({
      title: `已切换为${identity === 'villager' ? '村民' : '数字游民'}`,
      icon: 'success'
    })
  }
}

// 切换通知
const toggleNotification = (event: any) => {
  settings.value.notificationEnabled = event.target.checked
  
  if (typeof uni === 'undefined') {
    alert(event.target.checked ? '已启用通知' : '已禁用通知')
  } else {
    uni.showToast({
      title: event.target.checked ? '已启用通知' : '已禁用通知',
      icon: 'success'
    })
  }
}

// 切换隐私模式
const togglePrivacy = (event: any) => {
  settings.value.privacyMode = event.target.checked
  
  if (typeof uni === 'undefined') {
    alert(event.target.checked ? '已启用隐私模式' : '已禁用隐私模式')
  } else {
    uni.showToast({
      title: event.target.checked ? '已启用隐私模式' : '已禁用隐私模式',
      icon: 'success'
    })
  }
}

// 切换主题
const toggleTheme = (event: any) => {
  const theme = event.target.checked ? 'dark' : 'light'
  settings.value.theme = theme
  
  if (typeof uni === 'undefined') {
    alert(`已切换为${theme === 'dark' ? '深色' : '浅色'}主题`)
  } else {
    uni.showToast({
      title: `已切换为${theme === 'dark' ? '深色' : '浅色'}主题`,
      icon: 'success'
    })
  }
}

// 编辑资料
const goToEditProfile = () => {
  if (typeof uni === 'undefined') {
    alert('编辑资料页面')
  } else {
    uni.navigateTo({
      url: '/pages/user-center/edit-profile'
    })
  }
}

// 编辑背景
const editBackground = () => {
  if (typeof uni === 'undefined') {
    alert('背景选择器')
  } else {
    // 打开背景选择器
  }
}

// 清除缓存
const clearCache = () => {
  if (typeof uni === 'undefined') {
    if (confirm('确定要清除所有缓存数据吗？')) {
      alert('缓存已清除')
    }
  } else {
    uni.showModal({
      title: '清除缓存',
      content: '确定要清除所有缓存数据吗？',
      success: (res) => {
        if (res.confirm) {
          uni.clearStorageSync()
          uni.showToast({ title: '缓存已清除', icon: 'success' })
        }
      }
    })
  }
}

// 关于应用
const goToAbout = () => {
  if (typeof uni === 'undefined') {
    alert('关于应用页面')
  } else {
    uni.navigateTo({
      url: '/pages/about/index'
    })
  }
}

// 退出登录
const logout = () => {
  if (typeof uni === 'undefined') {
    if (confirm('确定要退出登录吗？')) {
      alert('已退出登录')
    }
  } else {
    uni.showModal({
      title: '退出登录',
      content: '确定要退出登录吗？',
      success: (res) => {
        if (res.confirm) {
          uni.showToast({ title: '已退出登录', icon: 'success' })
          setTimeout(() => {
            uni.reLaunch({
              url: '/pages/index/index'
            })
          }, 1000)
        }
      }
    })
  }
}

// 返回
const goBack = () => {
  if (typeof uni === 'undefined') {
    window.history.back()
  } else {
    uni.navigateBack()
  }
}
```

---

## 📱 响应式设计

### 小屏幕（< 576px）

- 设置项高度：50px
- 字体缩小 10%
- 间距缩小 10%

### 中屏幕（576px - 768px）

- 设置项高度：60px
- 标准字体
- 标准间距

### 大屏幕（> 768px）

- 设置项高度：70px
- 字体放大 10%
- 间距放大 10%

---

## 🧪 测试清单

### 功能测试

- [ ] 页面加载正常
- [ ] 设置项显示正确
- [ ] 身份切换正常
- [ ] 通知开关正常
- [ ] 隐私模式开关正常
- [ ] 深色模式开关正常
- [ ] 清除缓存正常
- [ ] 退出登录正常
- [ ] 导航跳转正常

### 界面测试

- [ ] 布局美观
- [ ] 文字清晰
- [ ] 颜色搭配
- [ ] 间距合理
- [ ] 分组清晰
- [ ] 开关显示正确

### 交互测试

- [ ] 返回按钮正常
- [ ] 开关切换流畅
- [ ] 导航按钮响应
- [ ] 确认对话框显示
- [ ] 成功提示显示

### 兼容性测试

- [ ] 浏览器环境
- [ ] uni-app 环境
- [ ] 微信小程序
- [ ] 不同屏幕尺寸

---

## 📝 开发检查清单

- [ ] 页面结构完整
- [ ] 样式规范统一
- [ ] 数据绑定正确
- [ ] 交互流程清晰
- [ ] 错误处理完善
- [ ] 状态管理正确
- [ ] 响应式适配
- [ ] 代码注释完整
- [ ] 文档更新完整

---

**文档版本**：1.0.0  
**最后更新**：2026-02-12  
**维护者**：Kiro AI Assistant
