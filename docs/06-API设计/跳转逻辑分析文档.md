# æ—…å±…æœåŠ¡ç«™ - è·³è½¬é€»è¾‘åˆ†ææ–‡æ¡£

## ä¸€ã€å½“å‰è·³è½¬é€»è¾‘çŠ¶æ€æ¦‚è§ˆ

### 1. é¦–é¡µæ¨¡å— (pages/home/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| index.js | æœç´¢æˆ¿æº | /pages/home/search/search | âœ… å·²å®ç° |
| index.js | å‘å¸ƒæˆ¿æº | /pages/house/publish/publish | âœ… å·²å®ç° |
| index.js | æˆ¿æºåˆ—è¡¨ | /pages/house/listing/listing | âœ… å·²å®ç° |
| index.js | åˆ†ç±»ç­›é€‰ | /pages/house/listing/listing?category=xxx | âœ… å·²å®ç° |
| index.js | æˆ¿æºè¯¦æƒ… | /pages/house/detail/detail?id=xxx | âœ… å·²å®ç° |
| search.js | è¿”å›ä¸Šä¸€é¡µ | wx.navigateBack() | âœ… å·²å®ç° |
| search.js | æˆ¿æºè¯¦æƒ… | /pages/house/detail/detail?id=xxx | âœ… å·²å®ç° |

### 2. æˆ¿æºæ¨¡å— (pages/house/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| detail.js | å‘æ¶ˆæ¯ | /pages/user/message/chat?userId=xxx | âœ… å·²å®ç° |
| detail.js | æŸ¥çœ‹è¯„è®º | /pages/square/reviews/reviews?id=xxx | âœ… å·²å®ç° |
| detail.js | é¢„è®¢æˆ¿æº | /pages/house/booking/booking?id=xxx | âœ… å·²å®ç° |
| detail.js | å†™è¯„è®º | /pages/square/write-review/write-review?id=xxx | âœ… å·²å®ç° |
| listing.js | æˆ¿æºè¯¦æƒ… | /pages/house/detail/detail?id=xxx | âœ… å·²å®ç° |
| listing.js | æœç´¢æˆ¿æº | /pages/home/search/search | âœ… å·²å®ç° |
| publish.js | åœ°å›¾é€‰ç‚¹ | /pages/house/map-picker/map-picker | âœ… å·²å®ç° |
| booking.js | æ”¯ä»˜æˆåŠŸè¿”å› | wx.navigateBack() | âœ… å·²å®ç° |
| booking.js | æŸ¥çœ‹è®¢å• | /pages/user/orders/index | âŒ éœ€è¦æ·»åŠ  |

### 3. å¹¿åœºæ¨¡å— (pages/square/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| index.js | å¸–å­è¯¦æƒ… | /pages/square/detail/detail?id=xxx | âœ… å·²å®ç° |
| index.js | ç”¨æˆ·ä¸»é¡µ | /pages/user/profile/profile?id=xxx | âœ… å·²å®ç° |
| index.js | å¹¿åœºæœç´¢ | /pages/square/search/search | âœ… å·²å®ç° |
| index.js | å‘å¸ƒå¸–å­ | /pages/square/publish/publish | âœ… å·²å®ç° |
| detail.js | ç”¨æˆ·ä¸»é¡µ | /pages/user/profile/profile?id=xxx | âœ… å·²å®ç° |
| detail.js | æ ‡ç­¾ç­›é€‰ | /pages/square/index/index?tag=xxx | âœ… å·²å®ç° |
| detail.js | ç±»å‹ç­›é€‰ | /pages/square/index/index?type=xxx | âœ… å·²å®ç° |
| detail.js | ç›¸å…³å¸–å­ | /pages/square/detail/detail?id=xxx | âœ… å·²å®ç° |
| search.js | è¿”å›ä¸Šä¸€é¡µ | wx.navigateBack() | âœ… å·²å®ç° |
| search.js | å¸–å­è¯¦æƒ… | /pages/square/detail/detail?id=xxx | âœ… å·²å®ç° |
| search.js | ç”¨æˆ·ä¸»é¡µ | /pages/user/profile/profile?id=xxx | âœ… å·²å®ç° |
| publish.js | å‘å¸ƒæˆåŠŸè¿”å› | wx.navigateBack() | âœ… å·²å®ç° |
| reviews.js | ç”¨æˆ·ä¸»é¡µ | /pages/user/profile/profile?id=xxx | âœ… å·²å®ç° |
| reviews.js | å†™è¯„è®º | /pages/square/write-review/write-review?id=xxx | âœ… å·²å®ç° |
| write-review.js | å‘å¸ƒæˆåŠŸè¿”å› | wx.navigateBack() | âœ… å·²å®ç° |

### 4. ç”¨æˆ·ä¸­å¿ƒæ¨¡å— (pages/user/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| profile.js | è®¾ç½®é¡µé¢ | nav.routes.SETTINGS.MAIN | âŒ å¼•ç”¨è¿‡æ—¶ |
| profile.js | æˆ‘çš„å‘å¸ƒ | nav.routes.PROFILE.PUBLISH_LIST | âŒ å¼•ç”¨è¿‡æ—¶ |
| profile.js | æµè§ˆå†å² | nav.routes.PROFILE.HISTORY_LIST | âŒ å¼•ç”¨è¿‡æ—¶ |
| profile.js | é€€å‡ºç™»å½• | nav.routes.AUTH.LOGIN | âŒ å¼•ç”¨è¿‡æ—¶ |
| settings/index.js | ç¼–è¾‘èµ„æ–™ | nav.routes.PROFILE.EDIT_PROFILE | âŒ å¼•ç”¨è¿‡æ—¶ |
| edit-profile/index.js | ä¿å­˜æˆåŠŸè·³é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |
| orders/index.js | è®¢å•è¯¦æƒ… | åŠŸèƒ½å¼€å‘ä¸­ | âŒ éœ€è¦å®ç° |
| publish-list/index.js | ç¼–è¾‘å‘å¸ƒ | åŠŸèƒ½å¼€å‘ä¸­ | âŒ éœ€è¦å®ç° |
| publish-list/index.js | æ–°å¢å‘å¸ƒ | åŠŸèƒ½å¼€å‘ä¸­ | âŒ éœ€è¦å®ç° |

### 5. è®¤è¯æ¨¡å— (pages/auth/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| login/index.js | å·²ç™»å½•è·³é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |
| login/index.js | æ¸¸å®¢æ¨¡å¼è·³é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |
| login/index.js | ç¼–è¾‘èµ„æ–™ | /pages/user/edit-profile/index | âœ… å·²å®ç° |
| login/index.js | å…ˆçœ‹çœ‹è·³é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |
| identity/index.js | ç¡®è®¤èº«ä»½è·³é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |

### 6. å…¬å…±é¡µé¢ (pages/common/)

| é¡µé¢ | è·³è½¬åŠŸèƒ½ | ç›®æ ‡é¡µé¢ | çŠ¶æ€ |
|------|----------|----------|------|
| report-success.js | è¿”å›é¦–é¡µ | /pages/home/index/index | âœ… å·²å®ç° |

---

## äºŒã€éœ€è¦ä¿®å¤çš„é—®é¢˜

### é—®é¢˜1: ç”¨æˆ·ä¸­å¿ƒæ¨¡å—å¼•ç”¨è¿‡æ—¶çš„è·¯ç”±é…ç½®

**å½±å“æ–‡ä»¶:**
- `pages/user/profile/profile.js`
- `pages/user/settings/index.js`

**é—®é¢˜æè¿°:**
è¿™äº›æ–‡ä»¶ä½¿ç”¨äº† `nav.routes.PROFILE.xxx` å’Œ `nav.routes.SETTINGS.xxx` çš„æ—§å¼•ç”¨æ–¹å¼ï¼Œä½† `config/routes.js` å·²ç»æ›´æ–°ä¸ºæ–°çš„å‘½åç©ºé—´ï¼š
- `PROFILE` â†’ `USER`
- `SETTINGS.MAIN` â†’ `USER.SETTINGS`

**ä¿®å¤æ–¹æ¡ˆ:**
æ›´æ–°å¼•ç”¨ä¸ºæ–°è·¯ç”±é…ç½®ï¼š
```javascript
// æ—§å¼•ç”¨
nav.routes.PROFILE.PUBLISH_LIST
nav.routes.SETTINGS.MAIN

// æ–°å¼•ç”¨
nav.routes.USER.PUBLISH_LIST
nav.routes.USER.SETTINGS
```

### é—®é¢˜2: ç¼ºå°‘è®¢å•è¯¦æƒ…é¡µè·³è½¬

**å½±å“æ–‡ä»¶:**
- `pages/house/booking/booking.js`
- `pages/user/orders/index.js`

**é—®é¢˜æè¿°:**
é¢„è®¢æˆåŠŸåæ²¡æœ‰è·³è½¬åˆ°è®¢å•è¯¦æƒ…é¡µï¼Œè®¢å•åˆ—è¡¨ç‚¹å‡»ä¹Ÿæ²¡æœ‰è·³è½¬ã€‚

**ä¿®å¤æ–¹æ¡ˆ:**
1. åœ¨ `booking.js` æ”¯ä»˜æˆåŠŸåæ·»åŠ è·³è½¬ï¼š
```javascript
wx.redirectTo({
  url: `/pages/user/orders/index?orderId=${orderId}`
})
```

2. åœ¨ `orders/index.js` æ·»åŠ è®¢å•è¯¦æƒ…è·³è½¬ï¼š
```javascript
viewOrderDetail(e) {
  const orderId = e.currentTarget.dataset.id
  wx.navigateTo({
    url: `/pages/user/orders/detail?id=${orderId}`
  })
}
```

### é—®é¢˜3: ç¼ºå°‘å‘å¸ƒç›¸å…³è·³è½¬

**å½±å“æ–‡ä»¶:**
- `pages/user/publish-list/index.js`

**é—®é¢˜æè¿°:**
ç¼–è¾‘å‘å¸ƒå’Œæ–°å¢å‘å¸ƒåŠŸèƒ½æœªå®ç°è·³è½¬é€»è¾‘ã€‚

**ä¿®å¤æ–¹æ¡ˆ:**
```javascript
// ç¼–è¾‘å‘å¸ƒ
editPublish(e) {
  const { id, type } = e.currentTarget.dataset
  if (type === 'house') {
    wx.navigateTo({ url: `/pages/house/publish/publish?id=${id}&mode=edit` })
  } else {
    wx.navigateTo({ url: `/pages/square/publish/publish?id=${id}&mode=edit` })
  }
}

// æ–°å¢å‘å¸ƒ
addPublish() {
  wx.showActionSheet({
    itemList: ['å‘å¸ƒæˆ¿æº', 'å‘å¸ƒå¸–å­'],
    success: (res) => {
      if (res.tapIndex === 0) {
        wx.navigateTo({ url: '/pages/house/publish/publish' })
      } else {
        wx.navigateTo({ url: '/pages/square/publish/publish' })
      }
    }
  })
}
```

---

## ä¸‰ã€éœ€è¦æ·»åŠ çš„æ–°è·³è½¬é€»è¾‘

### 1. ç”¨æˆ·ä¸»é¡µè·³è½¬ä¼˜åŒ–

**å½“å‰çŠ¶æ€:** ç”¨æˆ·ä¸»é¡µåªèƒ½æŸ¥çœ‹ï¼Œæ— æ³•è¿›è¡Œæ“ä½œ

**å»ºè®®æ·»åŠ :**
- ç‚¹å‡»å…³æ³¨æ•° â†’ å…³æ³¨åˆ—è¡¨é¡µ
- ç‚¹å‡»ç²‰ä¸æ•° â†’ ç²‰ä¸åˆ—è¡¨é¡µ
- ç‚¹å‡»å‘å¸ƒæ•° â†’ ç”¨æˆ·å‘å¸ƒåˆ—è¡¨

### 2. æˆ¿æºè¯¦æƒ…é¡µè·³è½¬ä¼˜åŒ–

**å»ºè®®æ·»åŠ :**
- ç‚¹å‡»æˆ¿ä¸œå¤´åƒ â†’ æˆ¿ä¸œä¸»é¡µ
- ç‚¹å‡»ç›¸ä¼¼æˆ¿æº â†’ æˆ¿æºè¯¦æƒ…

### 3. å¹¿åœºå¸–å­è·³è½¬ä¼˜åŒ–

**å»ºè®®æ·»åŠ :**
- ç‚¹å‡»ç‚¹èµåˆ—è¡¨ â†’ ç‚¹èµç”¨æˆ·åˆ—è¡¨
- ç‚¹å‡»æ”¶è—åˆ—è¡¨ â†’ æ”¶è—ç”¨æˆ·åˆ—è¡¨

---

## å››ã€è·¯ç”±é…ç½®æ›´æ–°å»ºè®®

### å½“å‰ config/routes.js ç»“æ„

```javascript
module.exports = {
  AUTH: { ... },
  HOME: { ... },
  USER: { ... },
  HOUSE: { ... },
  SQUARE: { ... },
  ADMIN: { ... },
  COMMON: { ... }
}
```

### å»ºè®®æ·»åŠ çš„è·¯ç”±

```javascript
module.exports = {
  // ... ç°æœ‰è·¯ç”±
  
  // è®¢å•ç›¸å…³è·¯ç”±ï¼ˆæ–°å¢ï¼‰
  ORDER: {
    DETAIL: '/pages/user/orders/detail',
    LIST: '/pages/user/orders/index'
  },
  
  // ç¤¾äº¤å…³ç³»è·¯ç”±ï¼ˆæ–°å¢ï¼‰
  RELATION: {
    FOLLOWERS: '/pages/user/relation/followers',
    FOLLOWING: '/pages/user/relation/following'
  }
}
```

---

## äº”ã€è·³è½¬é€»è¾‘å®ç°ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ï¼ˆå½±å“æ ¸å¿ƒåŠŸèƒ½ï¼‰
1. âœ… ä¿®å¤ç”¨æˆ·ä¸­å¿ƒæ¨¡å—çš„è·¯ç”±å¼•ç”¨
2. âœ… å®ç°è®¢å•è¯¦æƒ…è·³è½¬
3. âœ… å®ç°å‘å¸ƒç›¸å…³è·³è½¬

### ä¸­ä¼˜å…ˆçº§ï¼ˆæå‡ç”¨æˆ·ä½“éªŒï¼‰
4. å®ç°ç”¨æˆ·ä¸»é¡µçš„å…³æ³¨/ç²‰ä¸è·³è½¬
5. å®ç°æˆ¿æºè¯¦æƒ…çš„æˆ¿ä¸œä¸»é¡µè·³è½¬

### ä½ä¼˜å…ˆçº§ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰
6. å®ç°ç‚¹èµ/æ”¶è—ç”¨æˆ·åˆ—è¡¨
7. å®ç°ç›¸ä¼¼æˆ¿æºæ¨èè·³è½¬

---

## å…­ã€ç»Ÿä¸€è·³è½¬è§„èŒƒ

### æ¨èä½¿ç”¨æ–¹å¼

```javascript
// æ–¹å¼1: ä½¿ç”¨ navigation å·¥å…·ï¼ˆæ¨èï¼‰
const nav = require('../../../utils/navigation.js')
nav.navigateTo('USER.PROFILE', { id: userId })

// æ–¹å¼2: ç›´æ¥ä½¿ç”¨è·¯ç”±é…ç½®
const routes = require('../../../config/routes.js')
wx.navigateTo({ url: `${routes.USER.PROFILE}?id=${userId}` })

// æ–¹å¼3: ç›´æ¥å†™è·¯å¾„ï¼ˆä¸æ¨èï¼Œä½†å¯ç”¨ï¼‰
wx.navigateTo({ url: `/pages/user/profile/profile?id=${userId}` })
```

### è·³è½¬æ–¹æ³•é€‰æ‹©

| åœºæ™¯ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| æ™®é€šé¡µé¢è·³è½¬ | wx.navigateTo | ä¿ç•™å½“å‰é¡µï¼Œå¯è¿”å› |
| TabBaré¡µé¢è·³è½¬ | wx.switchTab | è·³è½¬åˆ°TabBaré¡µé¢ |
| å…³é—­å½“å‰é¡µè·³è½¬ | wx.redirectTo | ä¸ä¿ç•™å½“å‰é¡µ |
| è¿”å›ä¸Šä¸€é¡µ | wx.navigateBack | è¿”å›å†å²é¡µé¢ |
| é‡å¯åº”ç”¨ | wx.reLaunch | å…³é—­æ‰€æœ‰é¡µé¢ï¼Œæ‰“å¼€ç›®æ ‡é¡µ |

---

## ä¸ƒã€å¾…å®ç°åŠŸèƒ½æ¸…å•

### å·²å®Œæˆ âœ…
- [x] ä¿®å¤ç”¨æˆ·ä¸­å¿ƒæ¨¡å—è·¯ç”±å¼•ç”¨ï¼ˆprofile.js, settings/index.jsï¼‰
- [x] å®ç°é¢„è®¢æˆåŠŸè·³è½¬è®¢å•åˆ—è¡¨
- [x] å®ç°è®¢å•åˆ—è¡¨ç‚¹å‡»è·³è½¬è¯¦æƒ…
- [x] å®ç°å‘å¸ƒåˆ—è¡¨çš„ç¼–è¾‘è·³è½¬
- [x] å®ç°å‘å¸ƒåˆ—è¡¨çš„æ–°å¢è·³è½¬
- [x] æ›´æ–° navigation.js æ·»åŠ  switchTab/reLaunch/navigateBack æ–¹æ³•
- [x] å®ç°æµè§ˆå†å²è¯¦æƒ…è·³è½¬

### å¾…å¼€å‘ ğŸ“‹
- [ ] åˆ›å»ºè®¢å•è¯¦æƒ…é¡µé¢ `/pages/user/orders/detail`
- [ ] åˆ›å»ºå…³æ³¨/ç²‰ä¸åˆ—è¡¨é¡µé¢
- [ ] å®ç°ç”¨æˆ·ä¸»é¡µçš„å…³æ³¨/ç²‰ä¸è·³è½¬
- [ ] å®ç°åœ¨çº¿å®¢æœåŠŸèƒ½
- [ ] å®ç°æ„è§åé¦ˆåŠŸèƒ½
