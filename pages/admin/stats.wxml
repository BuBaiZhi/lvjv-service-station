<view class="container">
  <!-- æ—¶é—´é€‰æ‹© -->
  <view class="time-selector">
    <view class="time-tab {{currentTimeRange === 'day' ? 'active' : ''}}" bindtap="setTimeRange" data-range="day">ä»Šæ—¥</view>
    <view class="time-tab {{currentTimeRange === 'week' ? 'active' : ''}}" bindtap="setTimeRange" data-range="week">æœ¬å‘¨</view>
    <view class="time-tab {{currentTimeRange === 'month' ? 'active' : ''}}" bindtap="setTimeRange" data-range="month">æœ¬æœˆ</view>
    <view class="time-tab {{currentTimeRange === 'year' ? 'active' : ''}}" bindtap="setTimeRange" data-range="year">å…¨å¹´</view>
  </view>

  <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ï¼ˆå¯ç‚¹å‡»å¯¼å‡ºï¼‰ -->
  <view class="stats-cards">
    <view class="stat-card" bindtap="exportData" data-type="users">
      <text class="stat-value">{{stats.dau}}</text>
      <text class="stat-label">æ—¥æ´»ç”¨æˆ·</text>
      <text class="stat-trend up">â†‘ 12%</text>
    </view>
    <view class="stat-card" bindtap="exportData" data-type="newUsers">
      <text class="stat-value">{{stats.newUsers}}</text>
      <text class="stat-label">æ–°å¢ç”¨æˆ·</text>
      <text class="stat-trend up">â†‘ 8%</text>
    </view>
    <view class="stat-card" bindtap="exportData" data-type="posts">
      <text class="stat-value">{{stats.posts}}</text>
      <text class="stat-label">æ–°å¢å¸–å­</text>
      <text class="stat-trend down">â†“ 3%</text>
    </view>
    <view class="stat-card" bindtap="exportData" data-type="bookings">
      <text class="stat-value">{{stats.bookings}}</text>
      <text class="stat-label">é¢„è®¢é‡</text>
      <text class="stat-trend up">â†‘ 15%</text>
    </view>
  </view>

  <!-- ç”¨æˆ·åˆ†å¸ƒ -->
  <view class="chart-section">
    <view class="section-header">
      <text class="section-title">ç”¨æˆ·è§’è‰²åˆ†å¸ƒ</text>
      <text class="export-btn" bindtap="exportChart" data-type="users">ğŸ“Š å¯¼å‡º</text>
    </view>
    <view class="pie-chart">
      <view class="legend">
        <view class="legend-item">
          <view class="color-dot" style="background: #1e3d4c;"></view>
          <text>æ•°å­—æ¸¸æ°‘ {{userDistribution.nomad}}äºº ({{userDistribution.nomadPercent}}%)</text>
        </view>
        <view class="legend-item">
          <view class="color-dot" style="background: #6b8c7d;"></view>
          <text>æ‘æ°‘ {{userDistribution.villager}}äºº ({{userDistribution.villagerPercent}}%)</text>
        </view>
        <view class="legend-item">
          <view class="color-dot" style="background: #ff6b6b;"></view>
          <text>ç®¡ç†è€… {{userDistribution.admin}}äºº ({{userDistribution.adminPercent}}%)</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç”¨æˆ·å¢é•¿è¶‹åŠ¿ -->
  <view class="chart-section">
    <view class="section-header">
      <text class="section-title">ç”¨æˆ·å¢é•¿è¶‹åŠ¿</text>
      <text class="export-btn" bindtap="exportChart" data-type="trend">ğŸ“Š å¯¼å‡º</text>
    </view>
    <view class="trend-chart">
      <view class="chart-bars">
        <view class="chart-bar-item" wx:for="{{userTrend}}" wx:key="index">
          <view class="bar" style="height: {{item.value}}px;"></view>
          <text class="bar-label">{{item.date}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å†…å®¹ç»Ÿè®¡ -->
  <view class="content-stats">
    <view class="section-header">
      <text class="section-title">å†…å®¹ç»Ÿè®¡</text>
      <text class="export-btn" bindtap="exportAllData">ğŸ“¥ å¯¼å‡ºå…¨éƒ¨</text>
    </view>
    <view class="stat-row">
      <text class="row-label">å¸–å­æ€»æ•°</text>
      <text class="row-value">{{contentStats.totalPosts}}</text>
    </view>
    <view class="stat-row">
      <text class="row-label">æˆ¿æºæ€»æ•°</text>
      <text class="row-value">{{contentStats.totalHouses}}</text>
    </view>
    <view class="stat-row">
      <text class="row-label">è¯„è®ºæ€»æ•°</text>
      <text class="row-value">{{contentStats.totalComments}}</text>
    </view>
    <view class="stat-row">
      <text class="row-label">å¾…å®¡æ ¸å†…å®¹</text>
      <text class="row-value warning">{{contentStats.pendingCount}}</text>
    </view>
  </view>
</view>